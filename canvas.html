<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Drawing</title>
    <style>
        body{
            display:flex;
            justify-content:center;
            align-items: flex-start;
            height: 100vh;
            background: #f0f0f0;
        }
        .container {
           display: flex;
           flex-direction: column; 
           align-items: center;
           gap: 10px;
      }
        canvas{
            border:1px solid black;
            background: white;
            cursor: crosshair;
        }
        button{
            padding: 8px 16px;
            font-size: 16px;
            cursor: pointer;
        }
        button, input {
            padding: 5px 10px;
            font-size: 14px;
            cursor: pointer;
    }
    </style>
</head> 
<body>
    <div class="container">
    <button id="toogleMode">Eraser</button>

    <label>Pen Width: <input type="range" id="penWidth" min="1" max="20" value="3"></label>
    <label>Eraser Width: <input type="range" id="eraserWidth" min="5" max="50" value="10"></label>
    <button id="undo">Undo</button>
    <button id="redo">Redo</button>
    <canvas id="myCanvas" width="500" height="400"></canvas>
    </div>
    <script>
        let canvas=document.getElementById("myCanvas");
        let ctx=canvas.getContext("2d");
        
       ctx.lineWidth=3;
       ctx.lineCap="round";
       ctx.strokeStyle="black";

       let isDrawing=false;
       let lastX=0;
       let lastY=0;
       let isErasing=false;

       let undoStack=[];
       let redoStack=[];

       const penWidthInput = document.getElementById("penWidth");
       const eraserWidthInput = document.getElementById("eraserWidth");
       const toggleBtn = document.getElementById("toogleMode");

       saveSnap();

        toggleBtn.addEventListener('click',()=>{
            isErasing = !isErasing;
            toggleBtn.textContent = isErasing ? 'Pen' : 'Eraser'; 
            ctx.strokeStyle = isErasing ? 'white' : 'black';
            ctx.lineWidth = isErasing ? eraserWidthInput.value : penWidthInput.value;
        });


       document.getElementById("undo").addEventListener("click",()=>{
        if (undoStack.length===0) return;
        redoStack.push(canvas.toDataURL());
        restore(undoStack.pop());
       });

       document.getElementById("redo").addEventListener("click",()=>{
        if(redoStack.length===0) return;
        undoStack.push(canvas.toDataURL());
        restore(redoStack.pop());
       });

       penWidthInput.addEventListener("input", () => {
       if (!isErasing) ctx.lineWidth = penWidthInput.value;
        });

       eraserWidthInput.addEventListener("input", () => {
       if (isErasing) ctx.lineWidth = eraserWidthInput.value;
       });

       
       function saveSnap(){
        undoStack.push(canvas.toDataURL());
        redoStack=[];
       }

       function restore(snapshot){
        const img=new Image();
        img.src=snapshot;
        img.onload=()=>{
            ctx.clearRect(0,0,canvas.width,canvas.height);
            ctx.drawImage(img,0,0);

        };

       }


       canvas.addEventListener("mousedown",(e)=>{
        isDrawing=true;
        lastX=e.offsetX;
        lastY=e.offsetY;
        saveSnap();
       });

        canvas.addEventListener('mousemove',(e)=>{
            if(!isDrawing) return;
            ctx.beginPath();
            ctx.moveTo(lastX,lastY);
            ctx.lineTo(e.offsetX,e.offsetY);
            ctx.stroke();
            console.log("mousemove",e.offsetX,e.offsetY);
            [lastX,lastY]=[e.offsetX,e.offsetY];

        });
        canvas.addEventListener("mouseup",()=>{
         isDrawing=false;
        saveSnap();
        });
        canvas.addEventListener("mouseout",()=> isDrawing=false);

    </script>
    
</body>
</html>